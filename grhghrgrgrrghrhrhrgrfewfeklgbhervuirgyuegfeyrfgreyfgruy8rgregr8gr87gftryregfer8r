--// SERVICES
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

--// CONFIG (Daftar user premium)
local validUsers = {
	[9464607503] = {key = "NexaPremium_dngffvef", issuedDate = "18-09-2025"},
	[1444873051] = {key = "NexaPremium_6DB404IG", issuedDate = "20-09-2025"},
	[7854965065] = {key = "NexaPremium_91F3YK69", issuedDate = "22-09-2025"},
	[9529082141] = {key = "NexaPremium_91F3YK69", issuedDate = "26-09-2025"},
	[2314101743] = {key = "NexaPremium_U9IMV3YW", issuedDate = "01-10-2025"},
	[9348359815] = {key = "NexaPremium_NX81SW8V", issuedDate = "03-10-2025"},
	[8868906888] = {key = "NexaPremium_efewygwf", issuedDate = "04-10-2025"},
	[9114573649] = {key = "NexaPremium_6V9GNUC1", issuedDate = "05-10-2025"},
	[9383243342] = {key = "NexaPremium_P25P68X9", issuedDate = "05-10-2025"},
	[8427443610] = {key = "NexaPremium_YF3D5B0T", issuedDate = "06-10-2025"},
	[7962577003] = {key = "NexaPremium_R775Q6FY", issuedDate = "06-10-2025"},
	[8001911236] = {key = "NexaPremium_NFB0GALH", issuedDate = "07-10-2025"},
	[2322953887] = {key = "NexaPremium_NFB0GALH", issuedDate = "08-10-2025"},
	[9480072017] = {key = "NexaPremium_15PLV0Q7", issuedDate = "09-10-2025"},
	[9312857030] = {key = "NexaPremium_M48NWY9W", issuedDate = "12-10-2025"},
	[9576768452] = {key = "NexaPremium_CGBC6AH7", issuedDate = "Permanen"},
	[5464154339] = {key = "Owner", issuedDate = "Permanen"},
	[7507528154] = {key = "One1", issuedDate = "11-10-2025"},
	[8309815866] = {key = "Owner", issuedDate = "Permanen"},
	[8238519054] = {key = "Owner", issuedDate = "Permanen"},
}

local expireAfter = 30 * 24 * 60 * 60 -- 30 hari

--// UTILS
local function parseDate(str)
	if str == "Permanen" then return nil end
	local d, m, y = str:match("(%d+)%-(%d+)%-(%d+)")
	if d and m and y then
		return os.time({year = tonumber(y), month = tonumber(m), day = tonumber(d), hour = 0})
	end
	return os.time()
end

local function formatRemaining(secs)
	if secs == math.huge then return "âˆž Lifetime Access" end
	if secs <= 0 then return "Expired" end
	local d = math.floor(secs / 86400)
	local h = math.floor((secs % 86400) / 3600)
	local m = math.floor((secs % 3600) / 60)
	return string.format("%d days %02d hrs %02d min", d, h, m)
end

local function getExpiration(userData)
	if not userData then return 0 end
	if userData.issuedDate == "Permanen" then return math.huge end
	local issued = parseDate(userData.issuedDate) or os.time()
	return issued + expireAfter
end

--// NOTIFICATION
local function ShowNotification(text)
	local playerGui = player:WaitForChild("PlayerGui")
	if playerGui:FindFirstChild("NexaNotify") then playerGui.NexaNotify:Destroy() end

	local gui = Instance.new("ScreenGui", playerGui)
	gui.Name = "NexaNotify"

	local frame = Instance.new("Frame", gui)
	frame.Size = UDim2.new(0, 280, 0, 60)
	frame.Position = UDim2.new(0.5, 0, 0, -80)
	frame.AnchorPoint = Vector2.new(0.5, 0)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderColor3 = Color3.fromRGB(60, 60, 60)
	Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 6)

	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(1, -20, 1, 0)
	label.Position = UDim2.new(0, 10, 0, 0)
	label.BackgroundTransparency = 1
	label.TextWrapped = true
	label.Font = Enum.Font.Code
	label.TextSize = 14
	label.TextColor3 = Color3.fromRGB(255, 130, 0)
	label.Text = text

	TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Position = UDim2.new(0.5, 0, 0, 40)}):Play()
	task.delay(3, function()
		TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Position = UDim2.new(0.5, 0, 0, -80)}):Play()
		task.wait(0.3)
		gui:Destroy()
	end)
end

--// MAIN
local userData = validUsers[player.UserId]
local expiredTimestamp = getExpiration(userData)
local autoKey = rawget(getfenv(), "script_key")

-- AUTO KEY BYPASS
if userData and autoKey and autoKey == userData.key then
	local remainingTime = expiredTimestamp - os.time()
	if userData.issuedDate == "Permanen" then
		ShowNotification("ðŸ’Ž Welcome back, Lifetime User!")
	else
		ShowNotification("âœ… Premium Access: " .. formatRemaining(remainingTime))
	end
	task.wait(1)
	pcall(function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"))()
	end)
	return
end

--// SIMPLE GUI
local playerGui = player:WaitForChild("PlayerGui")
if playerGui:FindFirstChild("KeyGui") then playerGui.KeyGui:Destroy() end

local gui = Instance.new("ScreenGui", playerGui)
gui.Name = "KeyGui"

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 350, 0, 180)
frame.Position = UDim2.new(0.5, 0, 0.5, 0)
frame.AnchorPoint = Vector2.new(0.5, 0.5)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderColor3 = Color3.fromRGB(50, 50, 50)
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

TweenService:Create(frame, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Position = UDim2.new(0.5, 0, 0.5, -5)}):Play()

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 10)
title.BackgroundTransparency = 1
title.Font = Enum.Font.Code
title.TextSize = 18
title.TextColor3 = Color3.fromRGB(255, 130, 0)
title.Text = "Nexa Key System"

local keyBox = Instance.new("TextBox", frame)
keyBox.Size = UDim2.new(1, -40, 0, 30)
keyBox.Position = UDim2.new(0, 20, 0, 55)
keyBox.BackgroundColor3 = Color3.fromRGB(28, 28, 28)
keyBox.BorderColor3 = Color3.fromRGB(70, 70, 70)
keyBox.PlaceholderText = "Enter your key..."
keyBox.Font = Enum.Font.Code
keyBox.TextSize = 14
keyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
Instance.new("UICorner", keyBox).CornerRadius = UDim.new(0, 4)

local enterBtn = Instance.new("TextButton", frame)
enterBtn.Size = UDim2.new(1, -40, 0, 28)
enterBtn.Position = UDim2.new(0, 20, 0, 95)
enterBtn.BackgroundColor3 = Color3.fromRGB(38, 38, 38)
enterBtn.BorderColor3 = Color3.fromRGB(80, 80, 80)
enterBtn.Font = Enum.Font.Code
enterBtn.TextSize = 14
enterBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
enterBtn.Text = "Enter Key"
Instance.new("UICorner", enterBtn).CornerRadius = UDim.new(0, 4)

local freeBtn = Instance.new("TextButton", frame)
freeBtn.Size = UDim2.new(1, -40, 0, 28)
freeBtn.Position = UDim2.new(0, 20, 0, 130)
freeBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
freeBtn.BorderColor3 = Color3.fromRGB(70, 70, 70)
freeBtn.Font = Enum.Font.Code
freeBtn.TextSize = 14
freeBtn.TextColor3 = Color3.fromRGB(255, 130, 0)
freeBtn.Text = "Use Free Script"
Instance.new("UICorner", freeBtn).CornerRadius = UDim.new(0, 4)

--// LOGIC
enterBtn.MouseButton1Click:Connect(function()
	local input = keyBox.Text
	if not userData then
		ShowNotification("âŒ You are not a Premium user.")
		return
	elseif input == "" then
		ShowNotification("âš ï¸ Please enter your key.")
		return
	elseif input ~= userData.key then
		ShowNotification("âŒ Invalid key.")
		return
	end

	local remaining = expiredTimestamp - os.time()
	if userData.issuedDate == "Permanen" then
		gui:Destroy()
		ShowNotification("ðŸ’Ž Lifetime Access Granted!")
		task.wait(1)
		pcall(function()
			loadstring(game:HttpGet("https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"))()
		end)
	else
		if remaining <= 0 then
			ShowNotification("â° Your key has expired.")
			return
		else
			gui:Destroy()
			ShowNotification("âœ… Premium Access: " .. formatRemaining(remaining))
			task.wait(1)
			pcall(function()
				loadstring(game:HttpGet("https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"))()
			end)
		end
	end
end)

freeBtn.MouseButton1Click:Connect(function()
	gui:Destroy()
	ShowNotification("ðŸ’¡ Loading Free Script...")
	task.wait(1)
	pcall(function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/Gato290/Script/refs/heads/main/Nexa%20Free"))()
	end)
end)
